function t(t){return t.slice("/"===t[0]?1:void 0,"/"===t[t.length-1]?-1:void 0)}var e=new RegExp("((?:[\\w\\!\\$&'\\(\\)\\*\\+\\,;\\=\\:@\\-\\.~]|%[A-F0-9]{2})+)|(?:\\{(\\w+)(?:(\\*))?(\\?)?\\})","g");function r(t,e){if(!t.key||!e.key)return t.key?1:-1;if(t.wildcard&&e.wildcard)throw new Error("Route conflict wildcards: "+t.segment+" "+e.segment);return t.wildcard||e.wildcard?t.wildcard?1:-1:void 0}function n(n,a,i){var o=function(r){var n=[];return t(r).replace(e,function(t,e,r,a,i){n.push({segment:t,literal:e,key:r,isOptional:Boolean(i),isWildcard:Boolean(a)})}),n}(n);t:for(var l=0,d=i;l<o.length;++l){var c=l===o.length-1,s=o[l];s.children=[],s.literal=s.literal&&s.literal.toLowerCase();for(var h=0;h<d.children.length;++h){var u=d.children[h];if(u.segment===s.segment){if(c){if(u.data)throw new Error("Path conflict: "+n+" segment: "+s.segment);u.data=a;break}d=u;continue t}}if(s.isOptional&&c){if(null!=d.data)throw new Error("Path conflict: "+n+" segment: "+s.segment);d.data=a}c&&(s.data=a),d.children.push(s),d.children.sort(r),d=s}}function a(e,r){var n=t(e).split("/"),a=n.length-1,i={},o=null,l=r;t:for(var d=0;d<n.length;++d){for(var c=n[d],s=0;s<l.children.length;++s){var h=l.children[s];if(!h.key&&h.literal===c.toLowerCase()){l=h;continue t}if(h.key&&!h.isWildcard){i[h.key]=c,l=h;continue t}if(h.isWildcard){i[h.key]=n.splice(d,a),l=h;break}}o=n.slice(d,n.length).join("/");break}return{params:i,unmatched:o,node:l===r?null:l}}var i=function(t){void 0===t&&(t={});var e=t.routes;if(this.root={segment:"/",children:[],data:null},e)for(var r=0,n=e;r<n.length;r+=1){var a=n[r];this.set(a.path,a.data)}};i.prototype.set=function(t,e){if("/"===t){if(this.root.data)throw new Error('Route "/" already set.');this.root.data=e}else n(t,e,this.root)},i.prototype.get=function(t){if("/"===t)return this.root;var e=a(t,this.root).node;return this.root===e?null:e},i.prototype.match=function(t){if("/"===t)return{params:{},data:this.root.data,unmatched:null};var e=a(t,this.root);return{params:e.params,unmatched:e.unmatched,data:e.node?e.node.data:null}},module.exports=i;
//# sourceMappingURL=index.js.map
